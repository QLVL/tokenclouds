annotator, token_id,
sense_per_token) %>%
unique() %>%
count(type, sense_per_token) %>%
# count(batch, sense_per_token) %>%
# count(annotator, sense_per_token) %>%
# spread(sense_per_token, n, 0) %>%
ggplot() +
geom_bar(aes(fill = factor(sense_per_token),
x = type)) +
coord_flip()
sense_count %>%
filter(sense == 'geen') %>%
select(type, batch,
annotator, token_id,
sense_per_token) %>%
unique() %>%
count(type, sense_per_token) %>%
# count(batch, sense_per_token) %>%
# count(annotator, sense_per_token) %>%
# spread(sense_per_token, n, 0) %>%
ggplot() +
geom_col(aes(fill = factor(sense_per_token),
y = n,
x = type)) +
coord_flip()
sense_count %>%
filter(sense == 'geen') %>%
select(type, batch,
annotator, token_id,
sense_per_token) %>%
unique() %>%
count(batch, sense_per_token) %>%
# count(batch, sense_per_token) %>%
# count(annotator, sense_per_token) %>%
# spread(sense_per_token, n, 0) %>%
ggplot() +
geom_col(aes(fill = factor(sense_per_token),
y = n,
x = batch)) +
coord_flip()
sense_count %>%
filter(sense == 'geen') %>%
select(type, batch,
annotator, token_id,
sense_per_token) %>%
unique() %>%
count(annotator, sense_per_token) %>%
# count(batch, sense_per_token) %>%
# count(annotator, sense_per_token) %>%
# spread(sense_per_token, n, 0) %>%
ggplot() +
geom_col(aes(fill = factor(sense_per_token),
y = n,
x = annotator)) +
coord_flip()
sense_count %>%
filter(sense == 'geen') %>%
select(type, batch,
annotator, token_id,
sense_per_token) %>%
unique() %>%
# count(type, sense_per_token) %>%
# count(batch, sense_per_token) %>%
count(annotator, sense_per_token) %>%
# spread(sense_per_token, n, 0) %>%
# ggplot() +
# geom_col(aes(fill = factor(sense_per_token),
#              y = n,
#              x = type)) +
# coord_flip()
View()
sense_count %>%
filter(sense == 'geen') %>%
select(type, batch,
annotator, token_id,
sense_per_token) %>%
unique() %>%
# count(type, sense_per_token) %>%
# count(batch, sense_per_token) %>%
count(annotator, sense_per_token) %>%
spread(sense_per_token, n, 0) %>%
# ggplot() +
# geom_col(aes(fill = factor(sense_per_token),
#              y = n,
#              x = type)) +
# coord_flip()
View()
sense_count %>%
filter(sense == 'geen') %>%
select(type, batch,
annotator, token_id,
sense_per_token) %>%
unique() %>%
# count(type, sense_per_token) %>%
# count(batch, sense_per_token) %>%
count(annotator, sense_per_token) %>%
# spread(sense_per_token, n, 0) %>%
ggplot() +
geom_col(aes(fill = factor(sense_per_token),
y = n,
x = annotator),
position='fill') +
coord_flip()
sense_count %>%
filter(sense == 'geen') %>%
select(type, batch,
annotator, token_id,
sense_per_token) %>%
unique() %>%
# count(type, sense_per_token) %>%
# count(batch, sense_per_token) %>%
count(annotator, sense_per_token) %>%
# spread(sense_per_token, n, 0) %>%
ggplot() +
geom_col(aes(fill = factor(sense_per_token),
y = n,
x = annotator)
) +
coord_flip()
# View()
sense_count %>% count(annotator)
# View()
sense_count %>% count(annotator) %>%
arrange(desc(n))
# View()
sense_count %>% group_by(annotator) %>%
mutate(n = n()) %>%
filter(sense == 'geen') %>%
select(annotator, sense, n)
# View()
sense_count %>% group_by(annotator) %>%
mutate(n = n()) %>%
filter(sense == 'geen') %>%
select(annotator, sense, n) %>%
group_by(annotator) %>%
mutate(nn = n())
# View()
sense_count %>% group_by(annotator) %>%
mutate(n = n()) %>%
filter(sense == 'geen') %>%
select(annotator, sense, n) %>%
group_by(annotator) %>%
mutate(nn = n()) %>%
arrange(desc(n), desc(nn))
# View()
sense_count %>% group_by(annotator) %>%
mutate(n = n()) %>%
filter(sense == 'geen') %>%
select(annotator, sense, n) %>%
group_by(annotator) %>%
mutate(nn = n()) %>%
arrange(desc(n), desc(nn)) %>%
unique()
# View()
sense_count %>% group_by(annotator) %>%
mutate(n = n()) %>%
filter(sense == 'geen') %>%
select(annotator, sense, n) %>%
group_by(annotator) %>%
mutate(nn = n()) %>%
arrange(desc(n), desc(nn)) %>%
unique() %>% pull(annotator)
# View()
ann_order <- sense_count %>% group_by(annotator) %>%
mutate(n = n()) %>%
filter(sense == 'geen') %>%
select(annotator, sense, n) %>%
group_by(annotator) %>%
mutate(nn = n()) %>%
arrange(desc(n), desc(nn)) %>%
unique() %>% pull(annotator)
sense_count %>%
filter(sense == 'geen') %>%
select(type, batch,
annotator, token_id,
sense_per_token) %>%
unique() %>%
# count(type, sense_per_token) %>%
# count(batch, sense_per_token) %>%
count(annotator, sense_per_token) %>%
# spread(sense_per_token, n, 0) %>%
ggplot() +
geom_col(aes(fill = factor(sense_per_token),
y = n,
x = fct_relevel(annotator, ann_order))
) +
coord_flip()
library(knitr)
library(rmdformats)
library(kfigr)
library(kableExtra)
library(tidyverse)
## Global options
options(max.print="75")
opts_chunk$set(echo=FALSE,
cache=TRUE,
prompt=FALSE,
tidy=TRUE,
comment=NA,
message=FALSE,
warning=FALSE,
fig.width=4, fig.height=4)
opts_hooks$set(fig.cap = function(options){
# in this figr, the first TRUE indicates full caption (include 'Figure')
# FALSE points to adding a link (TRUE when I reference in text)
# the first and last arguments retrieve options from the chunk
first_part = figr(options$label, TRUE, FALSE, options$anchor)
text = options$fig.cap
options$fig.cap = paste0(first_part, ". ", text)
options
})
opts_knit$set(width=75)
```{r cap-this, include=FALSE}
# Function to fill the caption in TABLES with 'Table' and numeration;
capthis <- function(text){
# Check if it's knitting (otherwise can't retrieve chunk info)
is_knitting = length(opts_current$get()$label)>0
if(is_knitting){
# in this figr, the first TRUE indicates full caption (include 'Table')
# FALSE points to adding a link (TRUE when I reference in text)
# the first and last arguments retrieve options from the chunk
first_part = figr(opts_current$get()$label, TRUE, FALSE,
opts_current$get()$anchor)
return(paste0(first_part, ". ", text))
}
else {return(paste("TempCaption.", text))}
}
library(knitr)
library(rmdformats)
library(kfigr)
library(kableExtra)
library(tidyverse)
setwd("C:/Users/u0118974/Box Sync/Nederlands wolken/Output/Merges/")
tokens <- read_tsv("token_annotation.tsv", col_types = cols()) %>%
arrange(type, token_id)
batches <- read_tsv("batches.tsv")
INPUT_DIR <- "C:/Users/u0118974/Box Sync/Nederlands wolken/Output/Merges/"
input_dir <- "C:/Users/u0118974/Box Sync/Nederlands wolken/Output/Merges/"
tokens <- read_tsv(paste0(input_dir, "token_annotation.tsv"), col_types = cols()) %>%
arrange(type, token_id)
batches <- read_tsv(paste0(input_dir, "batches.tsv"))
types <- read_tsv(paste0(input_dir, "types.tsv"))
measure_agreement <- function(x, val, pop) {
if (x == 1) {
return("full")
} else if (x == 0) {
return("none")
} else if (val == pop) {
return("majority")
} else {
return("minority")
}
}
extract_agree <- function(a, b) {
tokens %>%
filter(batch == b) %>%
select(sense = paste0('sense_', str_extract(a, "[0-9]+")),
popular, agreement) %>%
mutate(agrees = pmap_chr(list(agreement, sense, popular),
measure_agreement)) %>%
mutate(batch = b, annotator = a) %>%
select(agrees, batch, annotator)
}
agreements <- bind_rows(map2(batches$annotator, batches$batch, extract_agree)) %>%
mutate(agrees = fct_relevel(agrees, "none", "minority", "majority", "full")) %>%
left_join(batches, by=c('batch', 'annotator'))
ggplot(agreements) +
geom_bar(aes(x = fct_relevel(code, code_by_full), fill=agrees)) +
labs(
title = 'Agreement per annotator per shift',
x = 'Number of tokens',
y = 'Annotator per shift',
fill = 'Agreement per token'
) +
coord_flip()
ggplot(agreements) +
geom_bar(aes(x = fct_relevel(code, code_by_full), fill=agrees)) +
labs(
title = 'Agreement per annotator per shift',
y = 'Number of tokens',
x = 'Annotator per shift',
fill = 'Agreement per token'
) +
coord_flip()
ggplot(agreements) +
geom_bar(aes(x = fct_relevel(username, usr_by_full), fill=agrees)) +
labs(
title = 'Agreement per annotator',
x = 'Number of tokens',
y = 'Annotator',
fill = 'Agreement per token'
) +
coord_flip()
ggplot(agreements) +
geom_bar(aes(x = fct_relevel(username, usr_by_full), fill=agrees)) +
labs(
title = 'Agreement per annotator',
x = 'Number of tokens',
y = 'Annotator',
fill = 'Agreement per token'
) +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(agreements) +
geom_bar(aes(x = fct_relevel(username, usr_by_full), fill=agrees)) +
labs(
title = 'Agreement per annotator',
y = 'Number of tokens',
x = 'Annotator',
fill = 'Agreement per token'
) +
theme(axis.text.x = element_text(
angle = 90, hjust = 1, size = 2
))
ggplot(agreements) +
geom_bar(aes(x = fct_relevel(username, usr_by_full), fill=agrees)) +
labs(
title = 'Agreement per annotator',
y = 'Number of tokens',
x = 'Annotator',
fill = 'Agreement per token'
) +
theme(axis.text.x = element_text(
angle = 90, hjust = 1, size = 5
))
ggplot(agreements) +
geom_bar(aes(x = fct_relevel(username, usr_by_full), fill=agrees)) +
labs(
title = 'Agreement per annotator',
y = 'Number of tokens',
x = 'Annotator',
fill = 'Agreement per token'
) +
theme(axis.text.x = element_text(
angle = 90, size = 5
))
ggplot(agreements) +
geom_bar(aes(x = fct_relevel(username, usr_by_full), fill=agrees)) +
labs(
title = 'Agreement per annotator',
y = 'Number of tokens',
x = 'Annotator',
fill = 'Agreement per token'
) +
theme(axis.text.x = element_text(
angle = 90, hjust = -1, size = 5
))
ggplot(agreements) +
geom_bar(aes(x = fct_relevel(username, usr_by_full), fill=agrees)) +
labs(
title = 'Agreement per annotator',
y = 'Number of tokens',
x = 'Annotator',
fill = 'Agreement per token'
) +
theme(axis.text.x = element_text(
angle = 90, hjust = 1, size = 5
))
ggplot(agreements) +
geom_bar(aes(x = fct_relevel(username, usr_by_full), fill=agrees)) +
labs(
title = 'Agreement per annotator',
y = 'Number of tokens',
x = 'Annotator',
fill = 'Agreement per token'
) +
theme(axis.text.x = element_text(
angle = 90, vjust = 1, size = 5
))
ggplot(agreements) +
geom_bar(aes(x = fct_relevel(username, usr_by_full), fill=agrees)) +
labs(
title = 'Agreement per annotator',
y = 'Number of tokens',
x = 'Annotator',
fill = 'Agreement per token'
) +
theme(axis.text.x = element_text(
angle = 90, vjust = 0, size = 5
))
ggplot(agreements) +
geom_bar(aes(x = fct_relevel(username, usr_by_full), fill=agrees)) +
labs(
title = 'Agreement per annotator',
y = 'Number of tokens',
x = 'Annotator',
fill = 'Agreement per token'
) +
theme(axis.text.x = element_text(
angle = 90, vjust = 0, hjust=1,size = 5
))
ggplot(agreements) +
geom_bar(aes(
x = fct_relevel(username, usr_by_full),
fill=agrees
), position = 'fill') +
labs(
title = 'Agreement per annotator',
y = 'Number of tokens',
x = 'Annotator',
fill = 'Agreement per token'
) +
theme(axis.text.x = element_text(
angle = 90, vjust = 0, hjust=1,size = 5
))
ggplot(tokens) +
geom_bar(aes(x = fct_relevel(type, type_by_tokens),
fill = factor(agreement))) +
labs(
title = "Agreement per type",
x = "Number of tokens",
y = "Type",
fill = "Percentage of agreement"
) +
coord_flip()
ggplot(tokens) +
geom_bar(aes(x = fct_relevel(type, type_by_tokens),
fill = agreement)) +
labs(
title = "Agreement per type",
x = "Number of tokens",
y = "Type",
fill = "Percentage of agreement"
) +
coord_flip()
ggplot(tokens) +
geom_bar(aes(x = fct_relevel(type, type_by_tokens),
fill = agreement)) +
labs(
title = "Agreement per type",
x = "Number of tokens",
y = "Type",
fill = "Percentage of agreement"
) +
coord_flip()
ggplot(tokens) +
geom_bar(aes(x = fct_relevel(type, type_by_tokens),
fill = factor(agreement))) +
labs(
title = "Agreement per type",
x = "Number of tokens",
y = "Type",
fill = "Percentage of agreement"
) +
coord_flip()
ggplot(tokens) +
geom_bar(aes(x = fct_relevel(type, type_by_tokens),
fill = factor(round(agreement, 1)))) +
labs(
title = "Agreement per type",
x = "Number of tokens",
y = "Type",
fill = "Percentage of agreement"
) +
coord_flip()
ggplot(tokens) +
geom_bar(aes(x = fct_relevel(type, type_by_tokens),
fill = factor(round(agreement, 2)))) +
labs(
title = "Agreement per type",
x = "Number of tokens",
y = "Type",
fill = "Percentage of agreement"
) +
coord_flip()
RColorBrewer::brewer.pal('OrRd')
ggplot(tokens) +
geom_bar(aes(x = fct_relevel(type, type_by_tokens),
fill = factor(round(agreement, 2))),
color = 'OrRd') +
labs(
title = "Agreement per type",
x = "Number of tokens",
y = "Type",
fill = "Percentage of agreement"
) +
coord_flip()
library(RColorBrewer)
brewer.pal(5, "OrRd")
ggplot(tokens) +
geom_bar(aes(x = fct_relevel(type, type_by_tokens),
fill = factor(round(agreement, 2)))) +
labs(
title = "Agreement per type",
x = "Number of tokens",
y = "Type",
fill = "Percentage of agreement"
) +
scale_fill_brewer(palette = 'OrRd') +
coord_flip()
ggplot(tokens) +
geom_bar(aes(x = fct_relevel(type, type_by_tokens),
fill = factor(round(agreement, 2)))) +
labs(
title = "Agreement per type",
x = "Number of tokens",
y = "Type",
fill = "Percentage of agreement"
) +
scale_fill_brewer(palette = 'YlGnBl') +
coord_flip()
ggplot(tokens) +
geom_bar(aes(x = fct_relevel(type, type_by_tokens),
fill = factor(round(agreement, 2)))) +
labs(
title = "Agreement per type",
x = "Number of tokens",
y = "Type",
fill = "Percentage of agreement"
) +
scale_fill_brewer(palette = 'YlGnBu') +
coord_flip()
